{% extends 'scout_app/base.html' %}
{% block content %}

<div>
    <form action="{% url 'lat_long_search' %}" method="post">
        {% csrf_token %}
        <div>
            <label for="latitude-input">Latitude</label>
            <input id="latitude-input" name="latitude" onkeydown="event.preventDefault()" required autocomplete="off" value="{{ class_latitude }}">
            
            <label for="longitude-input">Longitude</label>
            <input id="longitude-input" name="longitude" onkeydown="event.preventDefault()" required autocomplete="off" value="{{ class_longitude }}">
            
            <input type="submit" id="scout-button" class="btn btn-primary" name="lat_long_search" value="Scout">
        </div>
    </form>
</div>

<div class="tab">
    <button class="tablinks" onclick="openSource(event, 'Census')">Census</button>
    <button class="tablinks" onclick="openSource(event, 'Yelp')">Yelp</button>
</div>

<div class="tabcontent" id="Census">
    <span onclick="this.parentElement.style.display='none'" class="topright">x</span>

    <div class="container">
        {% if census_geography_data.incorporated_place_code %}
            <h3>Area information for {{ census_geography_data.incorporated_place_name }}, {{ census_geography_data.state_name }}</h3>
        {% elif census_geography_data.county_subdivision_code %}
            <h3>Area information for {{ census_geography_data.county_subdivision_name }}</h3>
            <h3>A subdivision of {{ census_geography_data.county_name }}, {{ census_geography_data.state_name }}</h3>
        {% elif census_geography_data.county_code %}
            <h3>Area information for {{ census_geography_data.county_name }}, {{ census_geography_data.state_name }}</h3>
        {% endif %}
    </div>

    <div class="container">
        <h4>Geography Data</h4>
        <table>
            <tr>
                <td>School district</td>
                <td>{{ census_geography_data.school_district_name }}</td>
            </tr>
        </table>
        <br>
    </div>

    {% for dataset in census_acs_display_data %}
    <div class="container">
        <h4>{{ dataset.title }}</h4>
        <table>
            {% for data in dataset.data %}
            <tr>
                <td>{{ data.label }}</td>
                <td>{{ data.value }}</td>
            </tr>
            {% endfor %}
        </table>
        <br>
    </div>
    {% endfor %}
    
</div>

<div class="tabcontent" id="Yelp">
    <span onclick="this.parentElement.style.display='none'" class="topright">x</span>
    
    <h4>Here are the results from Yelp</h4>
    <container>
        <div class="row">
        <table>
            {% for key,value in yelp_display_data.items %}
            <tr>
                <th>{{ key }}</th>
                <th>Address</th>
                <th>Phone</th>
                <th>Rating</th>
                <th>Website</th>
            </tr>
                {% for value in value.businesses %}
                <tr>
                    <td>{{ value.name }}</td>
                    <td>{{ value.location.address1 }}, {{ value.location.city }}, {{ value.location.state }} {{ value.location.zip_code }}</td>
                    <td>{{ value.display_phone }}</td>
                    <td>{{ value.rating }}/5</td>
                    <td><a target="_blank" href="{{ value.url }}">Yelp page</a></td>
                </tr>
                {% endfor %}
            <hr>
        {% endfor %}    
        </table>        
        </div>
    </container>

</div>

{{ yelp_display_data|json_script:"yelp-data-json" }}

<p data-lat="{{ latitude }}" id="latitude"></p>
<p data-long="{{ longitude }}" id="longitude"></p>


{% endblock %}

{% block javascript %}

<script>

    

</script>

{% endblock %}
